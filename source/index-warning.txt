.. _intellij-index-warning:

=====================
Missing Index Warning
=====================

.. default-domain:: mongodb

.. meta:: 
   :description: The MongoDB for IntelliJ Plugin examines Java code for missing indexes.

.. contents:: On this page
   :local:
   :backlinks: none
   :depth: 1
   :class: singlecol

Definition
----------

The {+intellij-full+} examines application queries for index use. If a
query doesn't use an index, the plugin displays a warning.

To resolve the warning, create an index for the query. You can also
disable the warning.

Before adding an index, consider:

- Does the query run often enough that you are willing to reduce the
  write speed for faster reads?
- Can you change the query to use existing indexes? 

Example
-------

In the following example Java code snippet, the ``dispute.status`` field
is used in a query, but there is no index on the field:

.. code-block:: java
   :copyable: false
   :emphasize-lines: 3

   public List<Document> findAllPending DisputesByTypeFare() {
      return trips.find( Filters.and(
         Filters.eq( fieldName: "dispute.status", value: "pending" ),
         Filters.eq( fieldName: "dispute.type", value: "fare" )
      )).into( new ArrayList<> () );
   }

The plugin shows a missing index warning:

``This query will run without an index. If you plan on using this query
heavily in your application, you should create an index that covers this
query.``

The warning has a *quick action* link that you can click to create an
index for the query.

Create an Index
~~~~~~~~~~~~~~~

To create an index for the query, click the *Implement an Index* quick
action in the warning. The plugin displays initial code to create an
index that you can modify. The code shows recommended fields to
index.

So for this code:

client.getDatabase("sample_mflix")
                .getCollection("movies")
                .find(
                        Filters.ne("awards.text", "Comedy")
                )

We generate this index script:

// Potential fields to consider indexing: awards.text
// Learn about creating an index: https://www.mongodb.com/docs/v7.0/core/data-model-operations/#indexes
db.getSiblingDB("sample_mflix").getCollection("movies")
  .createIndex({ "<your_field_1>": 1 })

Disable Warning
~~~~~~~~~~~~~~~

To disable the index warning in the plugin, go to Settings > search for
Inspections > MongoDB > uncheck Query does not use an index.

Learn More
----------

- :ref:`intellij-connect`
- :ref:`intellij-autocomplete`
- :ref:`intellij-type-validation`
